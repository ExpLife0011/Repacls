<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Repacls by NoMoreFood</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Repacls</h1>
        <p class="header">Windows File Security Utility</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/NoMoreFood/Repacls/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/NoMoreFood/Repacls/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/NoMoreFood/Repacls">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/NoMoreFood">NoMoreFood</a></p>


      </header>
      <section>
        <h1>
<a id="repacls-usage-information" class="anchor" href="#repacls-usage-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Repacls Usage Information</h1>

<p>Link To Latest Binaries: <a href="https://github.com/NoMoreFood/Repacls/files/387976/Repacls.Binaries.-.v1.1.0.0.zip">Here</a></p>

<blockquote>
<p>repacls.exe /Path  ... other options ....</p>

<p>Repacls was developed to address large scale migrations, transitions, health
checks, and access control optimizations.  Repacls is multi-threaded and
employs account name caching to accelerate operation on large file servers
with millions of files.  It was developed to address a variety of platform
limitations, resource consumption concerns, and bugs within xcacls, icacls,
setacl, and subinacl.</p>

<p>Important: Unless otherwise specified, all repacls commands are recursive.</p>

<p>Repacls must be executed with administrator permissions and will attempt to
acquire the backup, restore, and take ownership privileges during its
execution.</p>

<p>Any command line parameter that accepts an account or domain name can also use
a SID string instead of the name.  This may be necessary if working with an
account or domain that is no longer resolvable.</p>

<h1>
<a id="global-options" class="anchor" href="#global-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Global Options</h1>

<p>Global Options affect the entire command regardless of where they appear in the
passed command line.  It is recommended to include them at the very beginning
or end of your command as to not confuse them with ordered parameters.</p>

<p>/Path
   Specifies the file or directory to process.  If a directory, the directory
   is processed recursively; all operations specified affect the directory
   and all files and folders under the directory (unless otherwise specified).
   This parameter is mandatory.</p>

<p>/Quiet
   Hides all non-error output. This option will greatly enhance performance if
   a large number of changes are being processed.  Alternatively, it is
   advisable to redirect console output to a file (using the &gt; redirector) if
  /Quiet cannot be specified.</p>

<p>/Threads 
   Specifies the number of threads to use while processing.  The default value
   of  '5' is usually adequate, but can be increased if performing changes
   over a higher-latency connection.  Since changes to a parent directory
   often affect the inherited security on children, the security of children
   objects are always processed after the the security on their parent objects
   are fully processed.</p>

<p>/WhatIf
   This option will analyze security and report on any potential changes
   without actually committing the data.  Use of /WhatIf is recommended for
   those first using the tool.</p>

<p>/NoHiddenSystem
   Use this option to avoid processing any file marked as both 'hidden' and
   'system'.  These are what Windows refers to 'operating system protected
   files' in Windows Explorer.</p>

<h1>
<a id="ordered-options" class="anchor" href="#ordered-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ordered Options</h1>

<p>Ordered Options are executed on each SID encountered in the security descriptor
in the order they are specified on the command line.  Executing commands in
this way is preferable to multiple commands because the security descriptor is
only read and written once for the entire command which is especially helpful
for large volumes.</p>

<h2>
<a id="commands-that-do-not-alter-security" class="anchor" href="#commands-that-do-not-alter-security" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Commands That Do Not Alter Security</h2>

<p>/PrintDescriptor
   Prints out the security descriptor to the screen.  This is somewhat useful
   for  seeing the under-the-cover changes to the security descriptor before
   and after a particular command.</p>

<p>/CheckCanonical
   This command inspects the DACL and SACL for canonical order compliance
   (i.e., the rules in the ACL are ordered as explicity deny, explicity allow,
   inherited deny, inherited allow).  If non-canonical entries are detected,
   it is recommended to inspect the ACL with icacls.exe or Windows Explorer
   to ensure the ACL is not corrupted in a more significant way.</p>

<p>/ExportDescriptor 
   Export the security descriptor to the file specified.  The file is
   outputted in the format of file|descriptor on each line.  The security
   descriptor is formated as specified in the documentation for
   ConvertSecurityDescriptorToStringSecurityDescriptor().</p>

<p>/FindAccount 
   Reports any instance of an account specified.</p>

<p>/FindDomain 
   Reports any instance of an account matching the specified domain.</p>

<p>/FindNullAcl
   Reports any instance of a null ACL.  A null ACL, unlike an empty ACL, allows
   all access (i.e., similar to an ACE with 'Everyone' with 'Full Control')</p>

<h2>
<a id="commands-that-can-alter-security-when-whatif-is-not-present" class="anchor" href="#commands-that-can-alter-security-when-whatif-is-not-present" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Commands That Can Alter Security (When /WhatIf Is Not Present)</h2>

<p>/AddAccountIfMissing 
   This command will ensure the account specified has full control access to
   path and all directories/files under the path either via explicit or
   inherited permissions.  This command does not take into account any
   permissions that would be granted to the specified user via group
   membership.  If the account does not have access, access is
   granted.  This command is useful to correct issues where a user or
   administrator has mistakenly removed an administrative group from some
   directories.</p>

<p>/Compact
   This command will look for mergable entires in the security descriptor and
   merge them.  For example, running icacls.exe  /grant Everyone:R
   followed by icacls.exe  /grant Everyone:(CI)(OI)(R) will produce
   two entries even those the second command supersedes the first one.
   Windows Explorer automatically merges these entries when display security
   information so you have to use other utilities to detect these
   inefficiencies.  While these's nothing inheritance wrong with these
   entires, it possible for them to result file system is performance
   degradation.</p>

<p>/MigrateDomain :
        This command will look to see whether any account in 
    has an identially-named account in .  If so, any entires
     are converted to use the new domain.  For example,
    'OldDomain\Domain Admins' would become 'NewDomain\Domain Admins'.  Since
    this operation relies on the names being resolvable, specifying a SID
    instead of domain name for this command does not work.</p>

<p>/RemoveAccount 
    Will remove  from the security descriptor.  If the specified name
    is found as the file owner, the owner is replaced by the builtin
    Administrators group.  If the specified name is found as the group owner
    (a defunct attribute that has no function in terms of security), it is
    also replace with the built-in Administrators group.</p>

<p>/RemoveOrphans 
   Remove any account whose SID is derived from the  specified
   and can no longer be resolved to a valid name.</p>

<p>/RemoveRedundant
   This command will remove any explicit permission that is redundant of
   of the permissions its already given through inheritance.  This option
   helps recovered from the many indivual explicit permissions that may
   have been littered from the old cacls.exe command that didn't
   understand how to set up inheritance.</p>

<p>/ReplaceAccount  
   Search for an account and replace it with another account.</p>

<p>/SetOwner 
   Will set the owner of the file to the name specified.</p>

<p>/UpdateHistoricalSids
   Will convert any instances of old SIDs present in the security descriptor
   to there to active SID currently associated with the account.  This is
   especially useful after a domain migration and prior to removing
   excess SID history on accounts.</p>

<h1>
<a id="exclusive-options" class="anchor" href="#exclusive-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Exclusive Options</h1>

<p>/Help or /? or /H
   Shows this information.</p>

<p>/ResetChildren
   This will reset all children of path to the to inherit from the parant.  It
   will not affect the security of the parent.  This command does not affect
   the security the root directory as specified by the /Path argument.</p>

<p>/InheritChildren
   This will cause any parent that is currently set to block inheritance to
   start allowing inheritance.  Any explicit entries on the children are
   preserved.  This command does not will not affect the security the root
   directory as specified by the /Path argument.</p>

<h1>
<a id="other-notes--limitations" class="anchor" href="#other-notes--limitations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Other Notes &amp; Limitations</h1>

<p>To only affect a particular part of a security descriptor, you can add on an
optional ':X' parameter after the end of the account name where X is a comma
separated list of DACL,SACL, OWNER, or GROUP.  For example,
'/RemoveAccount "DOM\joe:DACL,OWNER"' will only cause the designated account
to be removed from the DACL and OWNER parts of the security descriptor.</p>

<h1>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h1>

<ul>
<li><p>Replace all instances of DOM\jack to DOM\jill in C:\test:
repacls.exe /Path C:\Test /ReplaceAccount "DOM\jack:DOM\jill"</p></li>
<li><p>Migrate all permissions for all accounts with matching
names in DOMA with DOMB:
repacls.exe /Path C:\Test /MigrateDomain DOMA:DOMB</p></li>
<li><p>Update old SID references, remove any explicit permissions that are already
granted by inherited permissions, and compact all ACLs if not compacted:
repacls.exe /Path C:\Test /UpdateHistoricalSids /RemoveRedundant /Compact</p></li>
</ul>

<p>Type 'repacls.exe /? | more' to scroll this documentation.</p>
</blockquote>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
